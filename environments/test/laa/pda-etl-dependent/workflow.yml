---
dag:
  repository: moj-analytical-services/laa_cwa_providers
  tag: 1.8.0
  retries: 1
  retry_delay: 150
  compute_profile: general-on-demand-8vcpu-32gb
  env_vars:
    ENVIRONMENT: dev
    LOG_LEVEL: INFO
    BUCKET_URL: >-
      s3://alpha-mojap-curated-laa-dev/pda/raw
    CACHE_DIRECTORY: >-
      s3://alpha-mojap-curated-laa-dev/pda/cache
    ERROR_SUMMARY_DIR: >-
      s3://alpha-mojap-curated-laa-dev/pda/error_summaries
    QUERY_RESULT_BUCKET: >-
      s3://aws-athena-query-results-593291632749-eu-west-1
    ATHENA_WORK_GROUP: primary
    CACHE_ENABLED: "true"
    DISABLE_COMPRESSION: "true"
    DLTHUB_TELEMETRY: "false"
    API_REQUEST_TIMEOUT: "30"
    API_MAX_RETRIES: "2"
    DEPENDENCY_BATCH_SIZE: "100"
    API_BASE_URL: >-
      https://laa-provider-details-api-preprod.apps.live.cloud-platform.service.justice.gov.uk/
    PIPELINE_DIR: providers_details_dev/
    DATABASE_NAME: laa_provider_raw_dev
  tasks:
    extract-fee_earners:
      env_vars:
        PIPELINE_NAME: providers_dev_fee_earners
        API_ENDPOINTS: fee_earners

    extract-provider_users:
      env_vars:
        PIPELINE_NAME: providers_dev_users
        API_ENDPOINTS: provider_users

    extract-provider_offices:
      env_vars:
        PIPELINE_NAME: providers_dev_offices
        API_ENDPOINTS: provider_offices

    extract-mediation_outreach:
      env_vars:
        PIPELINE_NAME: providers_dev_mediation_outreach
        API_ENDPOINTS: mediation_outreach

    extract-nms_authorisation:
      env_vars:
        PIPELINE_NAME: providers_dev_nms_authorisation
        API_ENDPOINTS: nms_authorisation

iam:
  athena: write
  glue: true
  s3_read_write:
    - alpha-mojap-curated-laa-dev/pda/*
    - aws-athena-query-results-593291632749-eu-west-1/*

secrets:
  - api-token

notifications:
  emails:
    - Ihuoma.Panton@justice.gov.uk
    - Damilola.Oyebade@justice.gov.uk
  slack_channel: laa-de-alerts

maintainers:
  - oplaa-collab
  - dami-moj

tags:
  business_unit: LAA
  owner: Ihuoma.Panton@justice.gov.uk
