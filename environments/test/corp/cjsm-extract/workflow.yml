---
dag:
  repository: moj-analytical-services/airflow-cjsm-api-data-extractor
  tag: v2.0.2-dev
  env_vars:
    AWS_DEFAULT_REGION: "eu-west-1"
  tasks:
    extract-messagedetails:
      env_vars:
        extraction_name: "messagedetails"
        PYTHON_SCRIPT_NAME: "process_cjsm_api.py"
        cjsm_env: "develop"
        environment: "dev"
        start_date: "2025-10-10"
    extract-applications:
      env_vars:
        extraction_name: "applications"
        PYTHON_SCRIPT_NAME: "process_cjsm_api.py"
        cjsm_env: "develop"
        environment: "dev"
        start_date: "2025-10-10"
        inflight_days_ago: 5
    extract-organisations:
      env_vars:
        extraction_name: "organisations"
        PYTHON_SCRIPT_NAME: "process_cjsm_api.py"
        cjsm_env: "develop"
        environment: "dev"
    extract-users:
      env_vars:
        extraction_name: "users"
        PYTHON_SCRIPT_NAME: "process_cjsm_api.py"
        cjsm_env: "develop"
        environment: "dev"

iam:
  athena: write
  s3_read_write:
    - mojap-land-dev/corporate/cjsm/*
    - mojap-athena-query-dump/*

secrets:
  - cjsm-scope
  - cjsm-client-id
  - cjsm-client-secret
  - slack-token

maintainers:
  - moj-supratikc
  - dugaldhepburnmoj

tags:
  business_unit: Central Digital
  owner: Supratik.Chowdhury@justice.gov.uk
